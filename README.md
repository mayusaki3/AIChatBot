# AIChatBot

AIChatBot ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® OpenAI API ã‚­ãƒ¼ã‚’ä½¿ã£ã¦ Discord ä¸Šã§ ChatGPT ã‚’åˆ©ç”¨ã§ãã‚‹ Bot ã§ã™ã€‚  
æ§‹æˆã¯ã€ŒUIå±¤ã€ã€ŒAIå±¤ã€ã€Œå…±é€šå±¤ã€ã«åˆ†ã‹ã‚Œã¦ãŠã‚Šã€å°†æ¥çš„ãªå¤šãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚

## ç’°å¢ƒå¤‰æ•°ã®è¨­å®šï¼ˆDiscordç”¨ï¼‰

1. `.env.example` ã‚’ `.env` ã«ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚
2. å¿…è¦ãª ãƒˆãƒ¼ã‚¯ãƒ³ãƒ»ID ã‚’ `.env` ã«è¨˜å…¥ã—ã¦ãã ã•ã„ï¼š
    ### ğŸ”¹ Discord Bot Token ã®å–å¾—æ‰‹é †
    1. [Discord Developer Portal](https://discord.com/developers/applications) ã«ã‚¢ã‚¯ã‚»ã‚¹
    2. ã€ŒNew Applicationã€ã‹ã‚‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
    3. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€ŒBotã€â†’ã€ŒAdd Botã€ã§Botã‚’è¿½åŠ 
    4. ã€ŒTokenã€â†’ã€ŒReset Tokenã€â†’ è¡¨ç¤ºã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚³ãƒ”ãƒ¼
    5. `.env` ã® DISCORD_BOT_TOKEN= ã«è²¼ã‚Šä»˜ã‘  
    ğŸ”’ æ³¨æ„ï¼šã“ã®ãƒˆãƒ¼ã‚¯ãƒ³ã¯çµ¶å¯¾ã«å¤–éƒ¨ã«å…¬é–‹ã—ãªã„ã§ãã ã•ã„ã€‚Gitã«å«ã‚ãªã„ã‚ˆã† `.gitignore` ã§ä¿è­·ã—ã¾ã™ã€‚
    
    ### ğŸ”¹ Discord Guild ID ã®å–å¾—æ‰‹é †ï¼ˆé–‹ç™ºæ™‚ã®ã¿ï¼‰
    1. Discordã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§Discordã«ã‚¢ã‚¯ã‚»ã‚¹
    2. ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š â†’ è©³ç´°è¨­å®š â†’ ã€Œé–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ã€ã‚’æœ‰åŠ¹åŒ–
    3. å¯¾è±¡ã®ã‚µãƒ¼ãƒãƒ¼åã‚’å³ã‚¯ãƒªãƒƒã‚¯ â†’ ã€ŒIDã‚’ã‚³ãƒ”ãƒ¼ã€
    4. `.env` ã® DISCORD_GUILD_ID= ã«è²¼ã‚Šä»˜ã‘

## èµ·å‹•æ–¹æ³•

```shell
pip install -r requirements.txt  # åˆå›ã®ã¿
python ui/discord/Discord_AIChatBot.py
```

## /ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§ï¼ˆDiscordï¼‰

AIChatBot ã¯ä»¥ä¸‹ã® /ã‚³ãƒãƒ³ãƒ‰ã‚’æä¾›ã—ã¦ã„ã¾ã™ï¼š

| åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰                   | èª¬æ˜                                                                   |
|--------------------------------|------------------------------------------------------------------------|
| `/ac_help`                     | ã™ã¹ã¦ã® /ac ã‚³ãƒãƒ³ãƒ‰ã®ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚                            |
| `/ac_template`                 | èªè¨¼æƒ…å ±è¨­å®šç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆJSONï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚               |
| `/ac_auth [file]`              | ä½¿ç”¨ã™ã‚‹AIãƒãƒ£ãƒƒãƒˆã®èªè¨¼æƒ…å ±ã‚’ç™»éŒ²ã—ã¾ã™ã€‚ [*1]                        |
| `/ac_removeauth`               | ç™»éŒ²ã—ãŸAIãƒãƒ£ãƒƒãƒˆã®èªè¨¼æƒ…å ±ã‚’å‰Šé™¤ã—ã¾ã™ã€‚ [*1]                        |
| `/ac_authsharing`              | èªè¨¼æƒ…å ±ãŒæœªç™»éŒ²ã®äººã«ç¾åœ¨ã®èªè¨¼æƒ…å ±ã‚’ã‚µãƒ¼ãƒãƒ¼å˜ä½ã§å…±æœ‰ã—ã¾ã™ã€‚ [*1]  |
| `/ac_authunsharing`            | ã‚µãƒ¼ãƒãƒ¼å˜ä½ã§å…±æœ‰ã•ã‚Œã¦ã„ã‚‹èªè¨¼æƒ…å ±ã®å…±æœ‰ã‚’è§£é™¤ã—ã¾ã™ã€‚ [*1]          |
| `/ac_imageuse`                 | ä½¿ç”¨ä¸­ã®ãƒ¢ãƒ‡ãƒ«ã«ç”»åƒå¯¾å¿œãƒãƒ¼ã‚¯ã‚’ä»˜ã‘ã¾ã™ã€‚ [*2]                        |
| `/ac_imagenonuse`              | ä½¿ç”¨ä¸­ã®ãƒ¢ãƒ‡ãƒ«ã«ç”»åƒéå¯¾å¿œãƒãƒ¼ã‚¯ã‚’ä»˜ã‘ã¾ã™ã€‚ [*2]                      |
| `/ac_status`                   | ä½¿ç”¨ä¸­ã®AIãƒãƒ£ãƒƒãƒˆã®çŠ¶æ…‹ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚                                 |
| `/ac_threads`                  | AIãƒãƒ£ãƒƒãƒˆã¨ä¼šè©±ä¸­ã®ã‚¹ãƒ¬ãƒƒãƒ‰ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚                         |
| `/ac_newchat [title] [Private]`| æ–°ã—ã„AIãƒãƒ£ãƒƒãƒˆã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ä½œæˆã—ã¾ã™ï¼ˆä»¶åã¯ä»»æ„ï¼‰                     |

[*1]: èªè¨¼æƒ…å ±ã¯ã€Œè‡ªåˆ†ã®èªè¨¼æƒ…å ±ã€ï¼ã€Œå…±æœ‰ã•ã‚ŒãŸèªè¨¼æƒ…å ±ã€ã®é †ã«ä½¿ç”¨ã—ã¾ã™ã€‚è‡ªåˆ†ã®èªè¨¼æƒ…å ±ã®ã¿å…±æœ‰ã§ãã€èª°ã®èªè¨¼æƒ…å ±ã§ã‚‚å…±æœ‰è§£é™¤ã§ãã¾ã™ã€‚
[*2]: ç”»åƒå¯¾å¿œãƒãƒ¼ã‚¯ãŒã¤ã„ã¦ã„ã‚‹ãƒ¢ãƒ‡ãƒ«ã¨ã®ãƒãƒ£ãƒƒãƒˆã§ã¯ã€æ·»ä»˜ã•ã‚ŒãŸç”»åƒã‚‚é€ä¿¡ã—ã¾ã™ã€‚

| ã‚¹ãƒ¬ãƒƒãƒ‰å†…ã‚³ãƒãƒ³ãƒ‰             | èª¬æ˜                                                                   |
|--------------------------------|------------------------------------------------------------------------|
| `/ac_invite`                   | AIChatBotã‚’ç¾åœ¨ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã«æ‹›å¾…ã—ã¾ã™ã€‚                                |
| `/ac_leave`                    | AIChatBotã‚’ç¾åœ¨ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã‹ã‚‰é€€å‡ºã•ã›ã¾ã™ã€‚                            |
| `/ac_newtopic`                 | æ–°ã—ããƒˆãƒ”ãƒƒã‚¯ã‚’å§‹ã‚ã¾ã™ã€‚ä»¥å‰ã®ä¼šè©±å†…å®¹ã¯å¿˜ã‚Œã¾ã™ã€‚                   |
| `/ac_loadtopic`                | ãƒˆãƒ”ãƒƒã‚¯ã‚’èª­ã¿ç›´ã—ã¾ã™ã€‚éå»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç·¨é›†/å‰Šé™¤ã—ãŸå ´åˆã«ä½¿ç”¨ã—ã¾ã™ã€‚|
| `/ac_summary`                  | ç¾åœ¨ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’è¦ç´„ã—ã€è¦ç´„å‰ã®ä¼šè©±å†…å®¹ã¯å¿˜ã‚Œã¾ã™ã€‚                   |

## ç’°å¢ƒå¤‰æ•°ã®è¨­å®šï¼ˆAIãƒãƒ£ãƒƒãƒˆç”¨ï¼‰

ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€èªè¨¼æƒ…å ±ï¼ˆJSONãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã™ã€‚  
1. `/ac_template` ã§èªè¨¼æƒ…å ±è¨­å®šç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
2. åˆ©ç”¨ã™ã‚‹AIãƒãƒ£ãƒƒãƒˆæ¯ã«ãƒªãƒãƒ¼ãƒ ã—ã¦ã€å¿…è¦ãªæƒ…å ±ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„ï¼š

    ### ğŸ”¹ OpenAI API Key ã®å–å¾—æ‰‹é †
    1. [OpenAI Platform](https://platform.openai.com/account/api-keys) ã«ãƒ­ã‚°ã‚¤ãƒ³
    2. ã€Œ+ Create new secret keyã€ã§APIã‚­ãƒ¼ã‚’ç”Ÿæˆ
    3. è¡¨ç¤ºã•ã‚ŒãŸ `sk-xxxxx...` å½¢å¼ã®ã‚­ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼
    4. /ac_template ã‚³ãƒãƒ³ãƒ‰ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸ JSONãƒ•ã‚¡ã‚¤ãƒ« ã® å„"api_key": ã«è²¼ã‚Šä»˜ã‘
    ğŸ”’ æ³¨æ„ï¼šã“ã®APIã‚­ãƒ¼ã¯çµ¶å¯¾ã«å¤–éƒ¨ã«å…¬é–‹ã—ãªã„ã§ãã ã•ã„ã€‚
    5. å¿…è¦ã«å¿œã˜ã¦åˆ©ç”¨ã™ã‚‹ãƒãƒ£ãƒƒãƒˆãƒ¢ãƒ‡ãƒ«ã‚’JSONãƒ•ã‚¡ã‚¤ãƒ« ã® å„"model": ã«è²¼ã‚Šä»˜ã‘
    6. å¿…è¦ã«å¿œã˜ã¦ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚ˆã‚Šãƒ­ã‚°ã‚¤ãƒ³ã—ã¦Billingã‚ˆã‚Šæ”¯æ‰•æ–¹æ³•ã‚„ä½¿ç”¨åˆ¶é™ã‚’è¨­å®š
       https://platform.openai.com/account/billing
    
3. åˆ©ç”¨ã™ã‚‹AIãƒãƒ£ãƒƒãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ `/ac_auth` ã‚³ãƒãƒ³ãƒ‰ã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚  
   AIãƒãƒ£ãƒƒãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹å ´åˆã¯ã€åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

   ### ğŸ”¹ èªè¨¼æƒ…å ±ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æ§‹æˆ
   `/ac_template` ã‚³ãƒãƒ³ãƒ‰ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹èªè¨¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ã€è¤‡æ•°ã® AI æ©Ÿèƒ½ï¼ˆãƒãƒ£ãƒƒãƒˆãƒ»ç”»åƒèªè­˜ãƒ»ç”»åƒç”Ÿæˆï¼‰ã«å¯¾å¿œã™ã‚‹ã‚ˆã†ã«æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚

    ```json
    {
      "chat": {
        "provider": "OpenAI",
        "api_key": "ã“ã“ã«ã‚ãªãŸã®OpenAI APIã‚­ãƒ¼ã‚’å…¥åŠ›",
        "model": "gpt-4o",
        "max_tokens": 1500,
        "summary_prompt": "ä»¥ä¸‹ã®ä¼šè©±ãƒ­ã‚°ã‚’ã€å†…å®¹ãŒã‚ã‹ã‚‹ã‚ˆã†ç°¡æ½”ã«è¦ç´„ã—ã¦ãã ã•ã„ã€‚è¿”ç­”ã«ã¯ã€Œäº†è§£ã—ã¾ã—ãŸã€ã‚„ã€Œè¦ç´„ã—ã¾ã™ã€ãªã©ã®å‰ç½®ãã¯ä¸è¦ã§ã™ã€‚è¦ç´„ã ã‘ã‚’è¿”ã—ã¦ãã ã•ã„ã€‚",
        "imagegen_prompt": "ä»¥ä¸‹ã®ä¼šè©±ãƒ­ã‚°ã‹ã‚‰ã€ç”»åƒç”Ÿæˆç”¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚è¿”ç­”ã«ã¯ã€Œäº†è§£ã—ã¾ã—ãŸã€ãªã©ã®å‰ç½®ãã¯ä¸è¦ã§ã™ã€‚ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã ã‘ã‚’è¿”ã—ã¦ãã ã•ã„ã€‚",
        "imagegen_keywords": [ "ç”Ÿæˆ", "æ", "ã‚¤ãƒ©ã‚¹ãƒˆ", "ç”»åƒ", "ã‚¤ãƒ¡ãƒ¼ã‚¸", "ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«" ]
      },
      "vision": {
        "provider": "OpenAI",
        "api_key": "ã“ã“ã«ã‚ãªãŸã®OpenAI APIã‚­ãƒ¼ã‚’å…¥åŠ›",
        "model": "gpt-4o",
        "vision_prompt": "ä»¥ä¸‹ã«æŒ™ã’ã‚‹ç”»åƒã‚’ã€ç”»åƒæ¯ã«ã€Œç”»åƒï¼‘ï¼ˆé€£ç•ªï¼‰ï¼šå†…å®¹ã€ã®å½¢å¼ã§è©³ã—ãèª¬æ˜ã—ã¦ãã ã•ã„ã€‚è¿”ç­”ã«ã¯ã€Œäº†è§£ã—ã¾ã—ãŸã€ãªã©ã®å‰ç½®ãã¯ä¸è¦ã§ã€å†…å®¹ã ã‘ã‚’è¿”ã—ã¦ãã ã•ã„ã€‚"
      },
      "imagegen": {
        "provider": "OpenAI",
        "api_key": "ã“ã“ã«ã‚ãªãŸã®OpenAI APIã‚­ãƒ¼ã‚’å…¥åŠ›",
        "model": "dall-e-3"
      }
    }
    ```
    
    ### ğŸ”¸ å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®èª¬æ˜
   
    - **chat**ï¼šãƒ†ã‚­ã‚¹ãƒˆä¼šè©±ã«ä½¿ç”¨ã™ã‚‹è¨­å®šã§ã™ã€‚`model` ã¯ GPT ç³»ã€`max_tokens` ã¯æœ€å¤§å¿œç­”ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã€`summary_prompt` ã¯è¦ç´„ç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã™ã€‚
    - **vision**ï¼šç”»åƒä»˜ããƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡¦ç†ã™ã‚‹éš›ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ç”»åƒã‚’å«ã‚€è³ªå•ãŒã‚ã‚‹å ´åˆã€ã“ã®è¨­å®šãŒã‚ã‚Œã°ç”»åƒã‚’å‡¦ç†ã§ãã¾ã™ã€‚
    - **imagegen**ï¼šç”»åƒç”Ÿæˆï¼ˆä¾‹ï¼šDALLÂ·Eï¼‰ç”¨ã®è¨­å®šã§ã™ã€‚
    
    > âš  å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã® `"provider"` ã¯ `"OpenAI"` ä»¥å¤–ã‚‚æŒ‡å®šå¯èƒ½ã§ã™ï¼ˆå°†æ¥å¯¾å¿œäºˆå®šï¼‰ã€‚  
    > âš  `vision` ã‚„ `imagegen` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒæœªæŒ‡å®šã®å ´åˆã€è©²å½“æ©Ÿèƒ½ã¯ç„¡åŠ¹ã«ãªã‚Šã¾ã™ã€‚

## æ‹›å¾…ãƒªãƒ³ã‚¯ã®è¨­å®š

AIChatBotã®æ‹›å¾…ãƒªãƒ³ã‚¯ã®ä½œæˆæ–¹æ³•ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
   1. [Discord Developer Portal](https://discord.com/developers/applications) ã«ã‚¢ã‚¯ã‚»ã‚¹
   2. My Applicationsã§ AIChatBot ã‚’é¸æŠ
   3. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€ŒOAuth2ã€â†’ã€ŒOAuth2 URL Generatorã€ã‚’è¡¨ç¤º
   4. ã€Œscopesã€ã§ä»¥ä¸‹ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯  
     - bot  
     - applications.commands  
   5. ã€ŒBot Permissionsã€ã§ä»¥ä¸‹ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯  
     - View Channels  
     - Send Messages  
     - Create Public Threads  
     - Create Private Threads  
     - Send Messages in threads  
     - Manage Threads  
     - Read Message History
     - Use Slash Commands  
   6. ã€ŒGenerated URLã€ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã€ã‚µãƒ¼ãƒãƒ¼ã‚’é¸æŠã—ã¦æ‹›å¾…

AIChatBot
https://discord.com/oauth2/authorize?client_id=1392390825148944406&permissions=397284543488&integration_type=0&scope=bot+applications.commands

AIChatBot Dev
https://discord.com/oauth2/authorize?client_id=1395576546747744357&permissions=397284543488&integration_type=0&scope=bot+applications.commands
